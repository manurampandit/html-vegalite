<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HTML-to-Vega-Lite List Example</title>
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
    <script src="../dist/index.umd.js"></script>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      .example {
        margin-bottom: 40px;
        border: 1px solid #ddd;
        border-radius: 5px;
        padding: 20px;
      }

      .html-input {
        background: #f5f5f5;
        padding: 15px;
        border-radius: 5px;
        margin-bottom: 20px;
        font-family: monospace;
        white-space: pre-wrap;
      }

      .vega-container {
        border: 1px solid #ccc;
        border-radius: 5px;
        padding: 10px;
      }
    </style>
  </head>

  <body>
    <!-- Page header -->
    <h1>HTML-to-Vega-Lite List Examples</h1>
    <p>
      This page demonstrates the new ListTagStrategy that supports HTML list
      tags (&lt;ul&gt;, &lt;ol&gt;, &lt;li&gt;).
    </p>

    <!-- Example 1 container -->
    <div class="example">
      <h2>Example 1: Simple Unordered List</h2>
      <div class="html-input" id="example1-html"></div>
      <div class="vega-container" id="example1-viz"></div>
    </div>

    <!-- Example 2 container -->
    <div class="example">
      <h2>Example 2: Simple Ordered List</h2>
      <div class="html-input" id="example2-html"></div>
      <div class="vega-container" id="example2-viz"></div>
    </div>

    <!-- Example 3 container -->
    <div class="example">
      <h2>Example 3: Nested Lists</h2>
      <div class="html-input" id="example3-html"></div>
      <div class="vega-container" id="example3-viz"></div>
    </div>

    <!-- Example 4 container -->
    <div class="example">
      <h2>Example 4: Lists with Styled Content</h2>
      <div class="html-input" id="example4-html"></div>
      <div class="vega-container" id="example4-viz"></div>
    </div>

    <!-- Example 5 container -->
    <div class="example">
      <h2>Example 5: Mixed Content Document</h2>
      <div class="html-input" id="example5-html"></div>
      <div class="vega-container" id="example5-viz"></div>
    </div>

    <script>
      // Demo input HTML snippets used by the examples below
      const examples = {
        example1: `<h3>Grocery List</h3>
                    <ul>
                        <li>Apples</li>
                        <li>Bananas</li>
                        <li>Milk</li>
                        <li>Bread</li>
                    </ul>`,

        example2: `<h3>Recipe Steps</h3>
                    <ol>
                        <li>Preheat oven to 350Â°F</li>
                        <li>Mix dry ingredients</li>
                        <li>Add wet ingredients</li>
                        <li>Bake for 25 minutes</li>
                    </ol>`,

        example3: `<h3>Project Structure</h3>
                    <ul>
                        <li>Frontend
                            <ol>
                                <li>Components</li>
                                <li>Services</li>
                                <li>Utils</li>
                            </ol>
                        </li>
                        <li>Backend
                            <ul>
                                <li>API</li>
                                <li>Database</li>
                                <li>Authentication</li>
                            </ul>
                        </li>
                    </ul>`,

        example4: `<h3>Task Priorities</h3>
                    <ol>
                        <li><b>High Priority</b>: Fix critical bugs</li>
                        <li><i>Medium Priority</i>: Add new features</li>
                        <li><u>Low Priority</u>: Update documentation</li>
                        <li><span style="color: red">Urgent</span>: Security patches</li>
                    </ol>`,

        example5: `<h1>Meeting Minutes</h1>
                    <p>Date: <b>March 15, 2024</b></p>
                    <p>Attendees:</p>
                    <ul>
                        <li>John Smith</li>
                        <li>Jane Doe</li>
                        <li>Bob Wilson</li>
                    </ul>
                    <p>Agenda:</p>
                    <ol>
                        <li>Project status review</li>
                        <li>Budget discussion</li>
                        <li>Next quarter planning</li>
                    </ol>
                    <p><i>Action items will be sent via email.</i></p>`,
      };

      /**
       * Render a single example: show raw HTML, convert to Vega-Lite, and embed.
       */
      async function renderExample(exampleId, html) {
        // Remove leading tabs/spaces from each line for display
        document.getElementById(exampleId + "-html").textContent = html
          .replace(/^ {20}/gm, "")
          .trim();

        try {
          const converter = new HTMLVegaLite.HTMLToVegaLite();
          const spec = converter.convert(html);
          await vegaEmbed("#" + exampleId + "-viz", spec, {
            theme: "quartz",
            renderer: "svg",
            actions: false,
          });
        } catch (error) {
          console.error("Error rendering example:", exampleId, error);
          document.getElementById(exampleId + "-viz").innerHTML =
            '<div style="color: red; padding: 20px;">Error: ' +
            error.message +
            "</div>";
        }
      }

      // Render all examples when page loads
      window.addEventListener("load", () => {
        Object.entries(examples).forEach(([key, html]) => {
          renderExample(key, html);
        });
      });
    </script>
  </body>
</html>
